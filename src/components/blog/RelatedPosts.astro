---
import { APP_BLOG } from 'astrowind:config';

import { getRandomPosts } from '~/utils/blog';
import { getPermalink } from '~/utils/permalinks';
import type { Post } from '~/types';

export interface Props {
  post: Post;
}

const { post } = Astro.props;

const randomPosts = await getRandomPosts(4, post);

// Format date for display (YYYY-MM-DD)
const formatArchiveDate = (date: Date): string => {
  return date.toISOString().split('T')[0];
};
---

{
  APP_BLOG.isRelatedPostsEnabled && randomPosts.length > 0 ? (
    <section class="max-w-2xl mx-auto px-6 sm:px-6 pt-8 pb-16">
      <h3 class="text-sm font-medium text-muted dark:text-slate-500 mb-2 tracking-wide">
        Other Interesting Curiosities
      </h3>
      <div class="border-t border-gray-200 dark:border-slate-700 mb-4"></div>
      <div class="space-y-1">
        {randomPosts.map((randomPost) => (
          <a
            href={getPermalink(randomPost.permalink, 'post')}
            class="block text-default hover:text-primary transition-colors py-1"
          >
            <span class="text-sm text-muted dark:text-slate-500 font-mono mr-4">
              {formatArchiveDate(randomPost.publishDate)}
            </span>
            <span class="text-base">{randomPost.title}</span>
          </a>
        ))}
      </div>
    </section>
  ) : null
}
